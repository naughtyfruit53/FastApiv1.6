{% extends "base_voucher.html" %}

{% set voucher_type_title = "Purchase Return" %}
{% set voucher_subtitle = "Debit Note" %}

{% block voucher_meta %}
<tr><td class="label">Date</td><td class="value">{{ voucher.date|format_date }}</td></tr>
<tr><td class="label">Return No</td><td class="value">{{ voucher.voucher_number|default('N/A') }}</td></tr>
{% if voucher.reference_number %}<tr><td class="label">Reference</td><td class="value">{{ voucher.reference_number }}</td></tr>{% endif %}
{% if voucher.original_invoice %}<tr><td class="label">Order Date</td><td class="value">{{ voucher.original_invoice_date|format_date|default('') }}</td></tr>{% endif %}
{% if voucher.original_invoice %}<tr><td class="label">Original Invoice</td><td class="value">{{ voucher.original_invoice }}</td></tr>{% endif %}
{% endblock %}

{% block after_blocks_grid %}
<div style="box-sizing: border-box; border-left: 1px solid #222; border-right: 1px solid #222; border-bottom: 1px solid #222; padding: 6px; font-size: 11px;">
    <div style="font-weight:700;">Reason for Return</div>
    <div>{{ voucher.return_reason|default('Quality/Specification issue') }}</div>
</div>
{% endblock %}

{% block totals_left %}
<div style="font-weight:700;">Terms and Conditions</div>
{% if terms_conditions %}
<table>
    <tbody>
        {% for term in terms_conditions.split('\n') %}
        {% if term|trim %}
        <tr><td>{{ loop.index }}. {{ term|trim }}</td></tr>
        {% endif %}
        {% endfor %}
    </tbody>
</table>
{% endif %}
{% endblock %}

{% block terms_block %}
{% endblock %}

{% block voucher_specific_footer %}
{% if voucher.payment_terms %}
<div style="margin-top: 15px;">
    <div class="section-title">Refund Terms</div>
    <div style="font-size: 10px;">
        {{ voucher.payment_terms }}
    </div>
</div>
{% endif %}

{% if voucher.notes %}
<div style="margin-top: 15px;">
    <div class="section-title">Additional Notes</div>
    <div style="font-size: 10px;">
        {{ voucher.notes }}
    </div>
</div>
{% endif %}

<div style="margin-top: 15px; font-size: 9px; color: #666; border-top: 1px solid #ddd; padding-top: 10px;">
    <strong>Return Declaration:</strong><br>
    • This debit note is issued for goods returned to vendor.<br>
    • Refund or credit expected as per purchase agreement.<br>
    • All returned items have been documented.<br>
    • Vendor to process refund as per terms.
</div>

<div style="margin-top: 15px; text-align: center; font-weight: bold; color: #2c3e50; border: 2px solid #f39c12; padding: 10px; background-color: #fef5e7;">
    DEBIT NOTE - PURCHASE RETURN ISSUED
</div>

{% if voucher.status == 'approved' %}
<div style="margin-top: 10px; text-align: center; font-weight: bold; color: #27ae60; border: 2px solid #27ae60; padding: 5px; background-color: #d5f4e6;">
    RETURN APPROVED - AWAITING REFUND
</div>
{% endif %}
{% endblock %}
