{% extends "base_voucher.html" %}

{% set voucher_type_title = "Quotation" %}
{% set voucher_subtitle = "Price Estimate" %}

{% block voucher_specific_info %}
<div class="voucher-info">
    <div class="section-title">Quotation Details</div>
    <div class="info-row">
        <span class="info-label">Quotation No:</span>
        <span class="info-value">{{ voucher.voucher_number|default('N/A') }}</span>
    </div>
    <div class="info-row">
        <span class="info-label">Date:</span>
        <span class="info-value">{{ voucher.date|format_date }}</span>
    </div>
    <div class="info-row">
        <span class="info-label">Valid Until:</span>
        <span class="info-value">{{ voucher.valid_until|format_date|default('30 days from date') }}</span>
    </div>
    {% if voucher.enquiry_number %}
    <div class="info-row">
        <span class="info-label">Enquiry No:</span>
        <span class="info-value">{{ voucher.enquiry_number }}</span>
    </div>
    {% endif %}
    {% if voucher.reference_number %}
    <div class="info-row">
        <span class="info-label">Your Reference:</span>
        <span class="info-value">{{ voucher.reference_number }}</span>
    </div>
    {% endif %}
    <div class="info-row">
        <span class="info-label">Delivery:</span>
        <span class="info-value">{{ voucher.delivery_terms|default('Ex-Works') }}</span>
    </div>
    <div class="info-row">
        <span class="info-label">Status:</span>
        <span class="info-value">
            <span class="status-badge">{{ voucher.status|default('Draft')|title }}</span>
        </span>
    </div>
</div>
{% endblock %}

{% block item_table_headers %}
<tr>
    <th class="item-cell" style="width: 5%;">Sl. No.</th>
    <th class="item-cell" style="width: 40%;">Product</th>
    <th class="item-cell" style="width: 10%;">HSN/SAC</th>
    <th class="item-cell" style="width: 10%;">Qty</th>
    <th class="item-cell" style="width: 10%;">Rate</th>
    {% if line_discount_enabled %}
    <th class="item-cell" style="width: 10%;">Disc. %</th>
    {% endif %}
    <th class="item-cell" style="width: 10%;">GST %</th>
    <th class="item-cell" style="width: 15%;">Amount</th>
</tr>
{% endblock %}

{% block item_table_rows %}
{% for item in items %}
<tr>
    <td class="item-cell">{{ loop.index }}</td>
    <td class="item-cell">
        <div>{{ item.product_name|default(item.product.product_name) }}</div>
        {% if item.description %}
        <div style="font-size: 8px; color: #666; margin-top: 2px;">{{ item.description }}</div>
        {% endif %}
    </td>
    <td class="item-cell">{{ item.hsn_code|default('N/A') }}</td>
    <td class="item-cell">{{ item.quantity }} {{ item.unit|default('') }}</td>
    <td class="item-cell">{{ item.unit_price|format_currency(show_symbol=False) }}</td>
    {% if line_discount_enabled %}
    <td class="item-cell">{{ item.discount_percentage|format_percentage }}%</td>
    {% endif %}
    <td class="item-cell">{{ item.gst_rate|format_percentage }}%</td>
    <td class="item-cell">{{ item.total_amount|format_currency(show_symbol=False) }}</td>
</tr>
{% endfor %}
{% endblock %}

{% block voucher_specific_footer %}
{% if voucher.delivery_terms %}
<div style="margin-top: 15px;">
    <div class="section-title">Delivery Terms</div>
    <div style="font-size: 10px;">
        {{ voucher.delivery_terms }}
    </div>
</div>
{% endif %}

{% if voucher.payment_terms %}
<div style="margin-top: 15px;">
    <div class="section-title">Payment Terms</div>
    <div style="font-size: 10px;">
        {{ voucher.payment_terms }}
    </div>
</div>
{% endif %}

<div style="margin-top: 15px; font-size: 9px; color: #666; border-top: 1px solid #ddd; padding-top: 10px;">
    <strong>Important Notes:</strong><br>
    • This quotation is valid for {{ voucher.validity_days|default(30) }} days from the date of issue.<br>
    • Prices are subject to change without prior notice after the validity period.<br>
    • All prices are exclusive of taxes unless mentioned otherwise.<br>
    • Final confirmation required before processing the order.<br>
    • Delivery timeline will be confirmed upon order confirmation.
</div>

<div style="margin-top: 15px; text-align: center; font-weight: bold; color: #2c3e50; border: 2px solid #3498db; padding: 10px; background-color: #ebf3fd;">
    Thank you for your enquiry. We look forward to your valuable order.
</div>

{% if voucher.status == 'converted' %}
<div style="margin-top: 10px; text-align: center; font-weight: bold; color: #27ae60; border: 2px solid #27ae60; padding: 5px; background-color: #d5f4e6;">
    QUOTATION CONVERTED TO ORDER
</div>
{% elif voucher.status == 'expired' %}
<div style="margin-top: 10px; text-align: center; font-weight: bold; color: #e74c3c; border: 2px solid #e74c3c; padding: 5px; background-color: #fadbd8;">
    QUOTATION EXPIRED
</div>
{% endif %}
{% endblock %}