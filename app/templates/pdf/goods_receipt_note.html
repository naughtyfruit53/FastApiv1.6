{% extends "base_voucher.html" %}

{% set voucher_type_title = "Goods Receipt Note" %}
{% set voucher_subtitle = "GRN" %}

{% block voucher_meta %}
<tr><td class="label">Date</td><td class="value">{{ voucher.date|format_date(format_str='%d/%m/%Y') }}</td></tr>
<tr><td class="label">GRN Number</td><td class="value">{{ voucher.voucher_number|default('N/A') }}</td></tr>
{% if voucher.reference_number %}<tr><td class="label">Reference</td><td class="value">{{ voucher.reference_number }}</td></tr>{% endif %}
{% if voucher.purchase_order %}<tr><td class="label">Order Date</td><td class="value">{{ voucher.purchase_order.date|format_date(format_str='%d/%m/%Y')|default('') }}</td></tr>{% endif %}
{% if voucher.purchase_order %}<tr><td class="label">PO Number</td><td class="value">{{ voucher.purchase_order.voucher_number|default('') }}</td></tr>{% endif %}
{% endblock %}

{% block items_table %}
<table class="items-table">
    <thead>
        <tr>
            <th style="width: 5%;">S.No</th>
            <th style="width: 25%;">Product</th>
            <th style="width: 15%;">HSN Code</th>
            <th style="width: 10%;">Ordered Qty</th>
            <th style="width: 15%;">Received Qty</th>
            <th style="width: 15%;">Accepted Qty</th>
            <th style="width: 15%;">Rejected Qty</th>
        </tr>
    </thead>
    <tbody>
        {% for item in items %}
        <tr>
            <td>{{ loop.index }}</td>
            <td>{{ item.product_name|default(item.product.product_name|default('N/A')) }}</td>
            <td>{{ item.hsn_code|default('N/A') }}</td>
            <td>{{ item.ordered_quantity|floatformat(2) }} {{ item.unit }}</td>
            <td>{{ item.received_quantity|floatformat(2) }} {{ item.unit }}</td>
            <td>{{ item.accepted_quantity|floatformat(2) }} {{ item.unit }}</td>
            <td>{{ item.rejected_quantity|floatformat(2) }} {{ item.unit }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}

{% block totals_left %}
<div style="font-weight:700;">Terms and Conditions</div>
{% if terms_conditions %}
<table>
    <tbody>
        {% for term in terms_conditions %}
        {% if term|trim %}
        <tr><td>{{ loop.index }}. {{ term|trim }}</td></tr>
        {% endif %}
        {% endfor %}
    </tbody>
</table>
{% endif %}
{% endblock %}

{% block totals_right %}
<!-- Remove totals table for GRN -->
{% endblock %}

{% block terms_block %}
{% endblock %}

{% block voucher_specific_footer %}
{% if voucher.notes %}
<div style="margin-top: 15px;">
    <div class="section-title">Additional Notes</div>
    <div style="font-size: 10px;">
        {{ voucher.notes }}
    </div>
</div>
{% endif %}

<div style="margin-top: 15px; text-align: center; font-weight: bold; color: #2c3e50; border: 2px solid #3498db; padding: 10px; background-color: #ebf3fd;">
    Goods receipt confirmed.
</div>
{% endblock %}
